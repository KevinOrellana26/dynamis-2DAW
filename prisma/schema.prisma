generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
  //output = "../node_modules/@prisma/client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

//1-invitado
//2-usuario
//3-admin
enum Rol {
  GUEST
  USER
  ADMIN
}

model User {
  id            String     @id @default(cuid())
  name          String?
  email         String     @unique
  emailVerified DateTime?
  password      String
  image         String?
  createdAt     DateTime   @default(now())
  updatedAt     DateTime   @updatedAt
  role          Rol        @default(USER)
  Progress      Progress[]
  Routine       Routine[]
  Favorite      Favorite[]
}

model Progress {
  id           Int       @id @default(autoincrement())
  usuario_id   String // Cambiado a String
  ejercicio_id Int
  fecha        DateTime? @default(now()) @db.Date
  peso_usado   Float
  repeticiones Int
  usuario      User      @relation(fields: [usuario_id], references: [id])
  ejercicio    Exercise  @relation(fields: [ejercicio_id], references: [id])
}

// Aplicar el mismo cambio a Routine y Favorite

model Routine {
  id               Int                @id @default(autoincrement())
  usuario_id       String
  nombre           String
  fecha_creacion   DateTime?          @default(now()) @db.Date
  usuario          User               @relation(fields: [usuario_id], references: [id])
  Rutina_ejercicio Rutina_ejercicio[]
}

model Favorite {
  id           Int      @id @default(autoincrement())
  usuario_id   String
  ejercicio_id Int
  // fecha_creacion DateTime? @default(now()) @db.Date
  usuario      User     @relation(fields: [usuario_id], references: [id])
  ejercicio    Exercise @relation(fields: [ejercicio_id], references: [id])
}

model Exercise {
  id               Int                @id @default(autoincrement())
  nombre           String
  musculo          String
  video_img_url    String
  Progreso         Progress[]
  Favorito         Favorite[]
  Rutina_ejercicio Rutina_ejercicio[]
}

model Rutina_ejercicio {
  id           Int      @id @default(autoincrement())
  rutina_id    Int
  ejercicio_id Int
  series       Int
  repeticiones Int
  rutina       Routine  @relation(fields: [rutina_id], references: [id])
  ejercicio    Exercise @relation(fields: [ejercicio_id], references: [id])
}
